---
target:
  metadata:
    product_name: &productName 'connected-facilities-staging'
    environment_name: &environmentName 'atg-cf-exp2-staging'
    default_azure_location: &defaultAzureLocation 'southcentralus'
    default_azure_subscription: &defaultAzureSubscription '5e49f516-d005-4ae8-a287-031c8573401c'  # Allspice-Dev
    service_deployment:
      tenant: &environmentTenant 'caadbe96-024e-4f67-82ec-fb28ff53d16d'  # Acuity Brands, Inc.
    app_registration:
      tenant: &appRegistrationTenant 'db566806-bf04-4296-98cc-ba6d2d950788'  # Acuity Brands Technical Services, INC
      application_id: &appRegistrationID '3a6085d9-676a-473c-832f-b73b2b7f7561'  # Acuity Brands Atrius Dev UI
  iaas:
    location: *defaultAzureLocation
    resource_groups:
      # pre-existing Atrius resource groups with shared configuration state
      - name: &atriusDnsRG 'atriusops-allspicedev'
        action: 'read'
      # CF Staging resource groups
      - name: &defaultRG 'atg-cf-exp2-rg'
        action: 'create'
      - name: &cfWafRG 'atg-cf-exp2-waf-rg'
        action: 'create'
      - name: &cfDbRG 'atg-cf-exp2-db-rg'
        action: 'create'
      - name: &cfKeysRG 'atg-cf-exp2-keys-rg'
        action: 'create'
      - name: &cfAcrRG 'atg-cf-exp2-acr-rg'
        action: 'create'
      - name: &cfNetworksRG 'atg-cf-exp2-networks-rg'
        action: 'create'
      - name: &cfAppSvcRG 'atg-cf-exp2-appsvc-rg'
        action: 'create'
      - name: &cfAuthNSvcRG 'atg-cf-exp2-authnsvc-rg'
        action: 'create'
      - name: &cfObserversRG 'atg-cf-exp2-observers-rg'
        action: 'create'
    networking:
      public_ip:
        - name: &wafIP 'atg-cf-exp2-waf-pip'
          resource_group: *cfNetworksRG
          subscription: *defaultAzureSubscription
          arm_type: 'Microsoft.Network/publicIPAddresses'
          action: 'create'
        - name: &postAuthnIP 'atg-cf-exp2-post-auth-pip'
          resource_group: *cfNetworksRG
          arm_type: 'Microsoft.Network/publicIPAddresses'
          action: 'create'
      dns_a_records:
        - zone: 'dev.atrius-iot.com'
          host: 'cf-staging'
          fqdn: 'cf-staging.dev.atrius-iot.com.'
          resource_group: *atriusDnsRG
          a_record_ttl: 3600
          a_record_public_ip: *wafIP
          action: 'create'
      vnets:
        - name: 'atg-cf-exp2-vnet'
          resource_group: *cfNetworksRG
          cidr: '10.1.0.0/16'
          arm_type: 'Microsoft.Network/virtualNetworks'
          action: 'create'
          subnets:
            - name: 'atg-cf-exp2-0-subnet'
              cidr: '10.1.0.0/24'
            - name: 'atg-cf-exp2-1-subnet'
              cidr: '10.1.1.0/24'
  paas:
    location: *defaultAzureLocation
    keyvaults:
      # pre-existing Atrius key vault with shared configuration state
      - name: &atriusKVName 'atrius01kvbxkbdsepg6'
        action: 'read'
      # CF Dev Key Vault
      - name: &kvName 'atg-cf-exp2-master-kv'
        resource_group: *cfKeysRG
        arm_type: 'Microsoft.KeyVault/vaults'
        action: 'create'
    databases:
      servers:
        - name: &cfDefaultDbServer 'atg-cf-exp2-sqls'
          arm_type: 'Microsoft.Sql/servers'
          resource_group: *cfDbRG
          admin_name: &cfDefaultDBAdminName 'atg-cf-exp2-sqls-admin-user'
          admin_password_kv:
            vault: &cfDefaultDBKeyVault 'CF-EXP-KV'  # retire this once build pipeline is available @@ TODO
            resource_group: 'CF-EXP'  # retire this once build pipeline is available @@ TODO
            secret_name: &cfDefaultDBSecretName 'admin-pw-for-atg-cf-exp2-sqls'
          action: 'preserve'
      instances:
        - name: 'atg-cf-exp2-admin'
          arm_type: 'Microsoft.Sql/servers/databases'
          resource_group: *cfDbRG
          server: *cfDefaultDbServer
          license_type: 'LicenseIncluded'
          max_size: '100G'
          zone_redundant: false
          catalog_collation: 'SQL_Latin1_General_CP1_CI_AS'
          collation: 'SQL_Latin1_General_CP1_CI_AS'
          capacity: 2
          tier: 'GeneralPurpose'
          family: 'Gen5'
          service_objective: 'GP_Gen5_2'
          action: 'preserve'
        - name: 'atg-cf-exp2-ingest'
          arm_type: 'Microsoft.Sql/servers/databases'
          resource_group: *cfDbRG
          server: *cfDefaultDbServer
          license_type: 'LicenseIncluded'
          max_size: '100G'
          zone_redundant: false
          catalog_collation: 'SQL_Latin1_General_CP1_CI_AS'
          collation: 'SQL_Latin1_General_CP1_CI_AS'
          capacity: 2
          tier: 'GeneralPurpose'
          family: 'Gen5'
          service_objective: 'GP_Gen5_2'
          action: 'preserve'
        - name: &selfHealingSchema 'atg-cf-exp2-self-healing'
          arm_type: 'Microsoft.Sql/servers/databases'
          resource_group: *cfDbRG
          server: *cfDefaultDbServer
          license_type: 'LicenseIncluded'
          max_size: '100G'
          zone_redundant: false
          catalog_collation: 'SQL_Latin1_General_CP1_CI_AS'
          collation: 'SQL_Latin1_General_CP1_CI_AS'
          capacity: 2
          tier: 'GeneralPurpose'
          family: 'Gen5'
          service_objective: 'GP_Gen5_2'
          action: 'preserve'
        - name: &healthSchema 'atg-cf-exp2-twin01-db'
          arm_type: 'Microsoft.Sql/servers/databases'
          resource_group: *cfDbRG
          server: *cfDefaultDbServer
          license_type: 'LicenseIncluded'
          max_size: '100G'
          zone_redundant: false
          catalog_collation: 'SQL_Latin1_General_CP1_CI_AS'
          collation: 'SQL_Latin1_General_CP1_CI_AS'
          capacity: 2
          tier: 'GeneralPurpose'
          family: 'Gen5'
          service_objective: 'GP_Gen5_2'
          action: 'preserve'
        - name: 'master'
          arm_type: 'Microsoft.Sql/servers/databases'
          resource_group: *cfDbRG
          server: *cfDefaultDbServer
          license_type: 'LicenseIncluded'
          max_size: '100G'
          zone_redundant: false
          catalog_collation: 'SQL_Latin1_General_CP1_CI_AS'
          collation: 'SQL_Latin1_General_CP1_CI_AS'
          capacity: 2
          tier: 'GeneralPurpose'
          family: 'Gen5'
          service_objective: 'GP_Gen5_2'
          action: 'preserve'
    server_farms:
      - name: &authServiceFarm 'atg-cf-exp2-authservice-asp'
        arm_type: 'Microsoft.Web/serverFarms'
        resource_group: *cfAuthNSvcRG
        is_linux: true
        number_of_workers: 1
        sku: 'PremiumV2'
        action: 'create'
      - name: &webServiceFarm 'atg-cf-exp2-webservice-asp'
        arm_type: 'Microsoft.Web/serverFarms'
        resource_group: *cfAppSvcRG
        is_linux: true
        number_of_workers: 1
        sku: 'PremiumV2'
        action: 'create'
    container_registries:
      - name: &primaryACR 'atg-cf-exp2-dev-registry'
        arm_type: 'Microsoft.ContainerRegistry/registries'
        resource_group: *cfAcrRG
        uri: &uriPrimaryACR 'https://atg-cf-exp2-dev-registry.azurecr.io'
        sku: 'Standard'
        admin_enabled: true
        action: 'create'
  saas:
    authn_services:
      farm: *authServiceFarm
      services:
        - name: &cfAuthnService 'atg-cf-exp2-auth-proxy'
          arm_type: 'Microsoft.Web/sites'
          resource_group: *cfAuthNSvcRG
          container:
            registry: *primaryACR
            name: &authnContainer 'cf-oauth-proxy-docker'
            tag: &authnTag 'connected-facilities'
          acr_webhook:
            name: 'atg-cf-exp2-auth-proxy-wh'
            registry: *primaryACR
            status: 'enabled'
            actions:
              - 'push'
            arm_type: 'Microsoft.ContainerRegistry/registries/webhooks'
          upstreamHost: &postAuthnGateway 'atg-cf-exp2-post-authn-ag'
          config:
            DOCKER_ENABLE_CI: true
            DOCKER_REGISTRY_SERVER_PASSWORD: ''
            DOCKER_REGISTRY_SERVER_URL: *uriPrimaryACR
            DOCKER_REGISTRY_SERVER_USERNAME: *primaryACR
            OAUTH2_PROXY_CLIENT_ID: *appRegistrationID
            OAUTH2_PROXY_CLIENT_SECRET: 'N:uB=Ru5x0B23iycRNTmNlz+sMDb=1UX'  # @@ TODO copy from AD setup
            OAUTH2_PROXY_COOKIE_EXPIRE: '20m'
            OAUTH2_PROXY_COOKIE_REFRESH: '5m'
            OAUTH2_PROXY_COOKIE_SECRET: 'tpXdkNP5Ugmjsq9AErIuQWROsrOFzZhwNjeUDcBtTm8='  # @@ TODO regen freuently
            OAUTH2_PROXY_EMAIL_DOMAINS: '*'
            OAUTH2_PROXY_EXTRA_JWT_ISSUERS: 'https://sts.windows.net/caadbe96-024e-4f67-82ec-fb28ff53d16d/=https://management.core.windows.net/'
            OAUTH2_PROXY_HTTP_ADDRESS: '0.0.0.0:4180'
            OAUTH2_PROXY_PASS_ACCESS_TOKEN: true
            OAUTH2_PROXY_PASS_AUTHORIZATION_HEADER: true
            OAUTH2_PROXY_PING_PATH: '/'
            OAUTH2_PROXY_PROVIDER: 'azure'
            OAUTH2_PROXY_REDIRECT_URL: 'https://cf.dev.atrius-iot.com/oauth2/callback'  # @@ TODO derive from FQDN
            OAUTH2_PROXY_SET_AUTHORIZATION_HEADER: true
            OAUTH2_PROXY_SILENCE_PING_LOGGING: true
            OAUTH2_PROXY_SKIP_JWT_BEARER_TOKENS: true
            OAUTH2_PROXY_SKIP_PROVIDER_BUTTON: true
            OAUTH2_PROXY_UPSTREAMS: 'http://atgcfexp-post-auth-pip.southcentralus.cloudapp.azure.com/'  # @@ TODO derive from upstream application gateway
            WEBSITES_ENABLE_APP_SERVICE_STORAGE: false
            WEBSITES_PORT: 4180
            WEBSITE_HTTPLOGGING_RETENTION_DAYS: 7
          connection_strings:
          container_settings:
            DOCKER_CUSTOM_IMAGE_NAME:
              - 'DOCKER|'
              - *primaryACR
              - '.azurecr.io/'
              - *authnContainer
              - ':'
              - *authnTag
            DOCKER_REGISTRY_SERVER_PASSWORD: ''
            DOCKER_REGISTRY_SERVER_URL: *uriPrimaryACR
            DOCKER_REGISTRY_SERVER_USERNAME: *primaryACR
            WEBSITES_ENABLE_APP_SERVICE_STORAGE: false
          action: 'create'
    web_services:
      farm: *webServiceFarm
      services:
        # Health services
        - name: &cfHealthApp 'atg-cf-exp2-app'
          arm_type: 'Microsoft.Web/sites'
          resource_group: *cfAppSvcRG
          container:
            registry: *primaryACR
            name: &healthAppContainer 'cf-react-app-docker'
            tag: &healthAppTag 'connected-facilities'
          acr_webhook:
            name: 'atg-cf-exp2-app-wh'
            registry: *primaryACR
            status: 'enabled'
            actions:
              - 'push'
            arm_type: 'Microsoft.ContainerRegistry/registries/webhooks'
          config:
            DOCKER_ENABLE_CI: true
            DOCKER_REGISTRY_SERVER_PASSWORD: ''
            DOCKER_REGISTRY_SERVER_URL: *uriPrimaryACR
            DOCKER_REGISTRY_SERVER_USERNAME: *primaryACR
            WEBSITES_ENABLE_APP_SERVICE_STORAGE: false
            WEBSITE_HTTPLOGGING_RETENTION_DAYS: 7
          connection_strings:
          container_settings:
            DOCKER_CUSTOM_IMAGE_NAME:
              - 'DOCKER|'
              - *primaryACR
              - '.azurecr.io/'
              - *healthAppContainer
              - ':'
              - *healthAppTag
            DOCKER_REGISTRY_SERVER_PASSWORD: ''
            DOCKER_REGISTRY_SERVER_USERNAME: *primaryACR
            DOCKER_REGISTRY_SERVER_URL: *uriPrimaryACR
            WEBSITES_ENABLE_APP_SERVICE_STORAGE: false
          action: 'create'
        - name: &cfHealthAdminApi 'atg-cf-exp2-admin-api'
          arm_type: 'Microsoft.Web/sites'
          resource_group: *cfAppSvcRG
          container:
            registry: *primaryACR
            name: &adminApiContainer 'cf-ruby-api-docker'
            tag: &adminApiTag 'connected-facilities'
          acr_webhook:
            name: 'atg-cf-exp2-admin-api-wh'
            registry: *primaryACR
            status: 'enabled'
            actions:
              - 'push'
            arm_type: 'Microsoft.ContainerRegistry/registries/webhooks'
          config:
            DOCKER_ENABLE_CI: true
            DOCKER_REGISTRY_SERVER_PASSWORD: ''
            DOCKER_REGISTRY_SERVER_URL: *uriPrimaryACR
            DOCKER_REGISTRY_SERVER_USERNAME: *primaryACR
            WEBSITES_ENABLE_APP_SERVICE_STORAGE: false
            WEBSITE_HTTPLOGGING_RETENTION_DAYS: 7
          connection_strings:
            SQLServer:
              db_funk: "funky monkey"
              DATABASE_URL:
                - 'sqlserver://'
                - *cfDefaultDBAdminName
                - ':'
                - '{{'
                - ' { secure_secret: {vault: '
                - *cfDefaultDBKeyVault
                - ', secret_name: '
                - *cfDefaultDBSecretName
                - '} '
                - '} '
                - '}}'
                - '@'
                - *cfDefaultDbServer
                - ':'
                - 1433
                - '/'
                - *healthSchema
          container_settings:
            DOCKER_CUSTOM_IMAGE_NAME:
              - 'DOCKER|'
              - *primaryACR
              - '.azurecr.io/'
              - *adminApiContainer
              - ':'
              - *adminApiTag
            DOCKER_REGISTRY_SERVER_PASSWORD: ''
            DOCKER_REGISTRY_SERVER_USERNAME: *primaryACR
            DOCKER_REGISTRY_SERVER_URL: *uriPrimaryACR
            WEBSITES_ENABLE_APP_SERVICE_STORAGE: false
          action: 'create'
        - name: &cfHealthApi 'atg-cf-exp2-health-api'
          arm_type: 'Microsoft.Web/sites'
          resource_group: *cfAppSvcRG
          container:
            registry: *primaryACR
            name: &healthApiContainer 'cf-ruby-api-docker'
            tag: &healthApiTag 'connected-facilities'
          acr_webhook:
            name: 'atg-cf-exp2-health-api-wh'
            registry: *primaryACR
            status: 'enabled'
            actions:
              - 'push'
            arm_type: 'Microsoft.ContainerRegistry/registries/webhooks'
          config:
            DOCKER_ENABLE_CI: true
            DOCKER_REGISTRY_SERVER_PASSWORD: ''
            DOCKER_REGISTRY_SERVER_URL: *uriPrimaryACR
            DOCKER_REGISTRY_SERVER_USERNAME: *primaryACR
            WEBSITES_ENABLE_APP_SERVICE_STORAGE: false
            WEBSITE_HTTPLOGGING_RETENTION_DAYS: 7
          connection_strings:
            SQLServer:
              DATABASE_URL:
                - 'sqlserver://'
                - *cfDefaultDBAdminName
                - ':'
                - '{{'
                - ' { secure_secret: {vault: '
                - *cfDefaultDBKeyVault
                - ', secret_name: '
                - *cfDefaultDBSecretName
                - '} '
                - '} '
                - '}}'
                - '@'
                - *cfDefaultDbServer
                - ':'
                - 1433
                - '/'
                - *healthSchema
          container_settings:
            DOCKER_CUSTOM_IMAGE_NAME:
              - 'DOCKER|'
              - *primaryACR
              - '.azurecr.io/'
              - *healthApiContainer
              - ':'
              - *healthApiTag
            DOCKER_REGISTRY_SERVER_PASSWORD: ''
            DOCKER_REGISTRY_SERVER_USERNAME: *primaryACR
            DOCKER_REGISTRY_SERVER_URL: *uriPrimaryACR
            WEBSITES_ENABLE_APP_SERVICE_STORAGE: false
          action: 'create'
        - name: &cfHealthIngestApi 'atg-cf-exp2-ingest-api'
          arm_type: 'Microsoft.Web/sites'
          resource_group: *cfAppSvcRG
          container:
            registry: *primaryACR
            name: &healthIngestContainer 'cf-ruby-api-docker'
            tag: &healthIngestTag 'connected-facilities'
          acr_webhook:
            name: 'atg-cf-exp2-ingest-api-wh'
            registry: *primaryACR
            status: 'enabled'
            actions:
              - 'push'
            arm_type: 'Microsoft.ContainerRegistry/registries/webhooks'
          config:
            DOCKER_ENABLE_CI: true
            DOCKER_REGISTRY_SERVER_PASSWORD: ''
            DOCKER_REGISTRY_SERVER_URL: *uriPrimaryACR
            DOCKER_REGISTRY_SERVER_USERNAME: *primaryACR
            WEBSITES_ENABLE_APP_SERVICE_STORAGE: false
            WEBSITE_HTTPLOGGING_RETENTION_DAYS: 7
          connection_strings:
            SQLServer:
              DATABASE_URL:
                - 'sqlserver://'
                - *cfDefaultDBAdminName
                - ':'
                - '{{'
                - ' { secure_secret: {vault: '
                - *cfDefaultDBKeyVault
                - ', secret_name: '
                - *cfDefaultDBSecretName
                - '} '
                - '} '
                - '}}'
                - '@'
                - *cfDefaultDbServer
                - ':'
                - 1433
                - '/'
                - *healthSchema
          container_settings:
            DOCKER_CUSTOM_IMAGE_NAME:
              - 'DOCKER|'
              - *primaryACR
              - '.azurecr.io/'
              - *healthIngestContainer
              - ':'
              - *healthIngestTag
            DOCKER_REGISTRY_SERVER_PASSWORD: ''
            DOCKER_REGISTRY_SERVER_USERNAME: *primaryACR
            DOCKER_REGISTRY_SERVER_URL: *uriPrimaryACR
            WEBSITES_ENABLE_APP_SERVICE_STORAGE: false
          action: 'create'
        # Self Healing services
        - name: &cfSelfHealingApp 'atg-cf-exp2-self-healing-app'
          arm_type: 'Microsoft.Web/sites'
          resource_group: *cfAppSvcRG
          container:
            registry: *primaryACR
            name: &shAPPContainer 'cf-self-healing-app-docker'
            tag: &shAPPTag 'connected-facilities'
          acr_webhook:
            name: 'atg-cf-exp2-self-healing-app-wh'
            registry: *primaryACR
            status: 'enabled'
            actions:
              - 'push'
            arm_type: 'Microsoft.ContainerRegistry/registries/webhooks'
          config:
            DOCKER_ENABLE_CI: true
            DOCKER_REGISTRY_SERVER_PASSWORD: ''
            DOCKER_REGISTRY_SERVER_URL: *uriPrimaryACR
            DOCKER_REGISTRY_SERVER_USERNAME: *primaryACR
            WEBSITES_ENABLE_APP_SERVICE_STORAGE: false
            WEBSITE_HTTPLOGGING_RETENTION_DAYS: 7
          connection_strings:
          container_settings:
            DOCKER_CUSTOM_IMAGE_NAME:
              - 'DOCKER|'
              - *primaryACR
              - '.azurecr.io/'
              - *shAPPContainer
              - ':'
              - *shAPPTag
            DOCKER_REGISTRY_SERVER_PASSWORD: ''
            DOCKER_REGISTRY_SERVER_USERNAME: *primaryACR
            DOCKER_REGISTRY_SERVER_URL: *uriPrimaryACR
            WEBSITES_ENABLE_APP_SERVICE_STORAGE: false
          action: 'create'
        - name: &cfSelfHealingApi 'atg-cf-exp2-self-healing-api'
          arm_type: 'Microsoft.Web/sites'
          resource_group: *cfAppSvcRG
          container:
            registry: *primaryACR
            name: &shAPIContainer 'cf-self-healing-api-docker'
            tag: &shAPITag 'connected-facilities'
          acr_webhook:
            name: 'atg-cf-exp2-self-healing-api-wh'
            registry: *primaryACR
            status: 'enabled'
            actions:
              - 'push'
            arm_type: 'Microsoft.ContainerRegistry/registries/webhooks'
          config:
            DOCKER_ENABLE_CI: true
            DOCKER_REGISTRY_SERVER_PASSWORD: ''
            DOCKER_REGISTRY_SERVER_URL: *uriPrimaryACR
            DOCKER_REGISTRY_SERVER_USERNAME: *primaryACR
            WEBSITES_ENABLE_APP_SERVICE_STORAGE: false
            WEBSITE_HTTPLOGGING_RETENTION_DAYS: 7
          connection_strings:
            SQLServer:
              DATABASE_URL:
                - 'sqlserver://'
                - *cfDefaultDBAdminName
                - ':'
                - '{{'
                - ' { secure_secret: {vault: '
                - *cfDefaultDBKeyVault
                - ', secret_name: '
                - *cfDefaultDBSecretName
                - '} '
                - '} '
                - '}}'
                - '@'
                - *cfDefaultDbServer
                - ':'
                - 1433
                - '/'
                - *selfHealingSchema
          container_settings:
            DOCKER_CUSTOM_IMAGE_NAME:
              - 'DOCKER|'
              - *primaryACR
              - '.azurecr.io/'
              - *shAPIContainer
              - ':'
              - *shAPITag
            DOCKER_REGISTRY_SERVER_PASSWORD: ''
            DOCKER_REGISTRY_SERVER_USERNAME: *primaryACR
            DOCKER_REGISTRY_SERVER_URL: *uriPrimaryACR
            WEBSITES_ENABLE_APP_SERVICE_STORAGE: false
          action: 'create'
    application_gateways:
      - name: 'atg-cf-exp2-waf-ag'
        arm_type: 'Microsoft.Network/applicationGateways'
        resource_group: *cfWafRG
        capacity: 2
        min_capacity: 2
        max_capacity: 10
        frontend_port: 443
        http_settings_cookie_based_affinity: 'Disabled'
        http_settings_port: 80
        http_settings_protocol: 'Http'
        http2: true
        routing_rule_type: 'Basic'
        sku: 'WAF_v2'
        servers:
          - *cfAuthnService
        private_ip_addresses: []
        public_ip_addresses:
          - *wafIP
        waf_policy: []
        waf_config:
          enabled: true
          file_upload_limit: '100mb'
          firewall_mode: 'Prevention'
          max_request_body_size: '128kb'
          request_body_check: true
          rule_set_type: 'OWASP'
          rule_set_version: '3.1'
        tls_certificate:
          origin:
            vault_name: *atriusKVName
            tls_secret_name: 'developer-devatrius-iotcom'
          deploy:
            vault_name: *kvName
            tls_cert_secret_name: 'developer-devatrius-iotcom-tls-cert'
            tls_password_secret_name: 'developer-devatrius-iotcom-password'
        action: 'preserve'
      - name: *postAuthnGateway
        arm_type: 'Microsoft.Network/applicationGateways'
        resource_group: *cfAuthNSvcRG
        capacity: 2
        min_capacity: 2
        max_capacity: 10
        frontend_port: 443
        http_settings_cookie_based_affinity: 'Disabled'
        http_settings_port: 80
        http_settings_protocol: 'Http'
        http2: true
        routing_rule_type: 'Basic'
        sku: 'WAF_v2'
        servers:
          - *cfHealthApp
          - *cfHealthAdminApi
          - *cfHealthApi
          - *cfHealthIngestApi
          - *cfSelfHealingApp
          - *cfSelfHealingApi
        private_ip_addresses: []
        public_ip_addresses:
          - *postAuthnIP
        waf_policy: []
        waf_config:
          enabled: false
        action: 'preserve'
